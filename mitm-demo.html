<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Man-in-the-Middle Attack Demo - Cookies Exposed</title>
    <meta name="description" content="Learn how Man-in-the-Middle attacks intercept cookies through interactive demonstrations and real-world scenarios">
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline';">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <div class="container">
                <div class="nav-content">
                    <a href="/" class="logo">
                        <div class="logo-icon">üç™</div>
                        Cookies Exposed
                    </a>
                    
                    <ul class="nav-menu">
                        <li><a href="/">Home</a></li>
                        <li><a href="cookie-scanner.html">Cookie Scanner</a></li>
                        <li class="nav-dropdown">
                            <a href="#" class="dropdown-toggle">Attack Demos ‚ñº</a>
                            <ul class="dropdown-menu">
                                <li><a href="session-hijacking.html">Session Hijacking</a></li>
                                <li><a href="xss-demo.html">XSS Cookie Theft</a></li>
                                <li><a href="csrf-demo.html">CSRF Attacks</a></li>
                                <li><a href="mitm-demo.html" class="active">Man-in-the-Middle</a></li>
                                <li><a href="cookie-poisoning.html">Cookie Poisoning</a></li>
                                <li><a href="tracking-demo.html">Tracking & Profiling</a></li>
                            </ul>
                        </li>
                        <li><a href="about.html">About</a></li>
                        <li><a href="privacy.html">Privacy</a></li>
                    </ul>
                    
                    <button class="theme-toggle" aria-label="Toggle dark mode">üåô</button>
                </div>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero-secondary">
        <div class="container">
            <div class="hero-content">
                <h1>üïµÔ∏è Man-in-the-Middle Attack Demo</h1>
                <p>Discover how attackers intercept cookie data by positioning themselves between users and servers</p>
            </div>
        </div>
    </section>

    <!-- Warning Section -->
    <section class="section">
        <div class="container">
            <div class="alert" style="background: linear-gradient(135deg, #ff6b6b, #ee5a52); color: white; text-align: center; margin-bottom: 2rem;">
                <h3 style="margin-top: 0; color: white;">‚ö†Ô∏è Educational Purpose Only</h3>
                <p style="margin-bottom: 0;">This demonstration is for security education. All examples are simulated and safe. Never attempt these attacks on real systems.</p>
            </div>
        </div>
    </section>

    <!-- What is MITM -->
    <section class="section">
        <div class="container">
            <div class="card">
                <h2>üîç What is a Man-in-the-Middle Attack?</h2>
                <p>A Man-in-the-Middle (MITM) attack occurs when an attacker secretly intercepts and potentially alters communications between two parties who believe they are communicating directly with each other.</p>
                
                <div class="grid grid-2 mt-lg">
                    <div>
                        <h3>How MITM Works with Cookies:</h3>
                        <ol>
                            <li><strong>User connects</strong> ‚Üí Thinks they're talking to legitimate server</li>
                            <li><strong>Attacker intercepts</strong> ‚Üí Positions between user and server</li>
                            <li><strong>Data flows through attacker</strong> ‚Üí Including cookies and sensitive data</li>
                            <li><strong>Attacker can modify/steal</strong> ‚Üí Or simply observe everything</li>
                        </ol>
                    </div>
                    <div>
                        <h3>Real-World Scenarios:</h3>
                        <ul>
                            <li>‚òï <strong>Coffee shop WiFi</strong> - Fake hotspots capture all traffic</li>
                            <li>üè¢ <strong>Corporate networks</strong> - Malicious insiders monitor connections</li>
                            <li>üåê <strong>ISP-level attacks</strong> - Compromised internet infrastructure</li>
                            <li>üì± <strong>Mobile networks</strong> - Rogue cell towers (IMSI catchers)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Network Visualization -->
    <section class="section">
        <div class="container">
            <div class="card">
                <h2>üåê Network Traffic Visualization</h2>
                <p>See how data flows in normal vs. compromised connections:</p>

                <div class="network-demo">
                    <div class="network-scenario" id="normalConnection">
                        <h3>Normal Secure Connection</h3>
                        <div class="network-diagram">
                            <div class="network-node user">
                                <div class="node-icon">üë§</div>
                                <div class="node-label">User</div>
                            </div>
                            <div class="connection-line secure" id="secureConnection">
                                <div class="data-packet" id="securePacket">üîí</div>
                                <div class="connection-label">HTTPS Encrypted</div>
                            </div>
                            <div class="network-node server">
                                <div class="node-icon">üñ•Ô∏è</div>
                                <div class="node-label">Server</div>
                            </div>
                        </div>
                        <button id="startSecureDemo" class="btn btn-success">Simulate Secure Connection</button>
                    </div>

                    <div class="network-scenario" id="mitmConnection">
                        <h3>Man-in-the-Middle Attack</h3>
                        <div class="network-diagram mitm">
                            <div class="network-node user">
                                <div class="node-icon">üë§</div>
                                <div class="node-label">User</div>
                            </div>
                            <div class="connection-line compromised" id="userToAttacker">
                                <div class="data-packet" id="packet1">üì¶</div>
                                <div class="connection-label">Unencrypted</div>
                            </div>
                            <div class="network-node attacker">
                                <div class="node-icon">üëπ</div>
                                <div class="node-label">Attacker</div>
                                <div class="intercepted-data" id="interceptedData" style="display: none;">
                                    <small>Intercepted: sessionId=abc123</small>
                                </div>
                            </div>
                            <div class="connection-line compromised" id="attackerToServer">
                                <div class="data-packet" id="packet2">üì¶</div>
                                <div class="connection-label">Forwarded</div>
                            </div>
                            <div class="network-node server">
                                <div class="node-icon">üñ•Ô∏è</div>
                                <div class="node-label">Server</div>
                            </div>
                        </div>
                        <button id="startMitmDemo" class="btn btn-danger">Simulate MITM Attack</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Interactive Demo -->
    <section class="section">
        <div class="container">
            <div class="card">
                <h2>üß™ Interactive MITM Simulation</h2>
                <p>Experience how different MITM attacks work in controlled environments:</p>

                <!-- Demo Tabs -->
                <div class="demo-tabs">
                    <button class="tab-btn active" data-tab="wifi">üì∂ WiFi Attack</button>
                    <button class="tab-btn" data-tab="ssl">üîì SSL Stripping</button>
                    <button class="tab-btn" data-tab="dns">üåê DNS Spoofing</button>
                    <button class="tab-btn" data-tab="certificate">üìú Certificate Attack</button>
                </div>

                <!-- WiFi Attack Demo -->
                <div class="demo-content active" id="wifi-demo">
                    <h3>Evil Twin WiFi Attack</h3>
                    <div class="demo-steps">
                        <div class="step">
                            <h4>Step 1: Attacker Sets Up Fake WiFi</h4>
                            <div class="wifi-networks">
                                <div class="wifi-network legitimate">
                                    <span class="wifi-name">üì∂ CoffeeShop_Guest</span>
                                    <span class="wifi-security">üîí WPA2</span>
                                </div>
                                <div class="wifi-network fake">
                                    <span class="wifi-name">üì∂ CoffeeShop_Guest</span>
                                    <span class="wifi-security">üîì Open</span>
                                    <span class="wifi-note">‚Üê Stronger signal!</span>
                                </div>
                            </div>
                            <button id="setupFakeWifi" class="btn btn-secondary">Setup Fake Network</button>
                        </div>

                        <div class="step" id="wifiStep2" style="display: none;">
                            <h4>Step 2: User Connects to Fake Network</h4>
                            <div class="user-perspective">
                                <p>üë§ User sees: "Great! Free WiFi with strong signal"</p>
                                <p>üîç Reality: All traffic now flows through attacker</p>
                            </div>
                            <button id="connectFakeWifi" class="btn btn-primary">User Connects</button>
                        </div>

                        <div class="step" id="wifiStep3" style="display: none;">
                            <h4>Step 3: Traffic Interception</h4>
                            <div class="traffic-capture">
                                <div class="captured-request">
                                    <h5>Intercepted HTTP Request:</h5>
                                    <pre class="code-block">
GET /account HTTP/1.1
Host: mybank.com
Cookie: sessionId=abc123xyz789; userPref=darkMode
User-Agent: Mozilla/5.0...
Authorization: Bearer eyJ0eXAiOiJKV1Q...</pre>
                                </div>
                                <div class="attack-result">
                                    <p class="text-danger">üö® <strong>Session Cookie Stolen!</strong></p>
                                    <p>Attacker now has full access to user's banking session</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SSL Stripping Demo -->
                <div class="demo-content" id="ssl-demo">
                    <h3>SSL Stripping Attack</h3>
                    <div class="ssl-demo-container">
                        <div class="browser-simulation">
                            <div class="address-bar">
                                <span id="sslUrl">http://mybank.com/login</span>
                                <span class="ssl-indicator" id="sslIndicator">üîì</span>
                            </div>
                            <div class="page-content">
                                <h4>Bank Login</h4>
                                <input type="text" placeholder="Username" readonly>
                                <input type="password" placeholder="Password" readonly>
                                <button id="sslLogin" class="btn btn-primary">Login</button>
                            </div>
                        </div>
                        
                        <div class="ssl-explanation">
                            <h4>What's Happening:</h4>
                            <ol>
                                <li>User types "mybank.com" in browser</li>
                                <li>Attacker intercepts and serves HTTP version</li>
                                <li>User doesn't notice missing HTTPS</li>
                                <li>Login credentials sent in plaintext</li>
                            </ol>
                            <button id="demonstrateSSL" class="btn btn-danger">Show SSL Strip</button>
                        </div>

                        <div id="sslResult" style="display: none;">
                            <div class="alert alert-danger">
                                <h4>SSL Stripping Successful!</h4>
                                <p>Captured credentials and session cookies in plaintext</p>
                                <pre>Username: user@example.com
Password: mySecretPassword123
Cookie: sessionId=vulnerable123</pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- DNS Spoofing Demo -->
                <div class="demo-content" id="dns-demo">
                    <h3>DNS Spoofing Attack</h3>
                    <div class="dns-demo-container">
                        <div class="dns-lookup">
                            <h4>DNS Resolution Process</h4>
                            <div class="dns-flow">
                                <div class="dns-step">
                                    <span>üë§ User enters: mybank.com</span>
                                </div>
                                <div class="dns-step">
                                    <span>üîç DNS Query: "What's the IP for mybank.com?"</span>
                                </div>
                                <div class="dns-step" id="dnsResponse">
                                    <span>üìç Normal Response: 203.0.113.10</span>
                                </div>
                                <div class="dns-step" id="maliciousResponse" style="display: none;">
                                    <span class="text-danger">üìç Malicious Response: 198.51.100.5 (Attacker's server)</span>
                                </div>
                            </div>
                            <button id="poisonDNS" class="btn btn-danger">Poison DNS Response</button>
                        </div>

                        <div id="dnsResult" style="display: none;">
                            <div class="fake-website">
                                <h4>Fake Banking Website</h4>
                                <p class="text-warning">‚ö†Ô∏è Looks identical to real site!</p>
                                <div class="login-form">
                                    <input type="text" placeholder="Username" readonly>
                                    <input type="password" placeholder="Password" readonly>
                                    <button class="btn btn-primary">Login</button>
                                </div>
                                <p class="text-danger">All credentials and cookies sent to attacker!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Certificate Attack Demo -->
                <div class="demo-content" id="certificate-demo">
                    <h3>Certificate Substitution Attack</h3>
                    <div class="cert-demo-container">
                        <div class="certificate-comparison">
                            <div class="cert-valid">
                                <h4>Valid Certificate</h4>
                                <div class="cert-details">
                                    <p><strong>Issued to:</strong> mybank.com</p>
                                    <p><strong>Issued by:</strong> DigiCert Inc</p>
                                    <p><strong>Status:</strong> ‚úÖ Valid</p>
                                    <p><strong>Fingerprint:</strong> A1:B2:C3:D4...</p>
                                </div>
                            </div>
                            <div class="cert-fake">
                                <h4>Attacker's Certificate</h4>
                                <div class="cert-details">
                                    <p><strong>Issued to:</strong> mybank.com</p>
                                    <p><strong>Issued by:</strong> Evil CA</p>
                                    <p><strong>Status:</strong> ‚ö†Ô∏è Self-signed</p>
                                    <p><strong>Fingerprint:</strong> X9:Y8:Z7:W6...</p>
                                </div>
                            </div>
                        </div>
                        
                        <button id="showCertWarning" class="btn btn-danger">Simulate Certificate Warning</button>
                        
                        <div id="certWarning" style="display: none;">
                            <div class="browser-warning">
                                <h4>üö® Your connection is not private</h4>
                                <p>Attackers might be trying to steal your information from mybank.com</p>
                                <p>The certificate is not valid.</p>
                                <div class="warning-actions">
                                    <button class="btn btn-secondary">Go back (safe)</button>
                                    <button class="btn btn-danger" id="proceedAnyway">Proceed anyway (dangerous)</button>
                                </div>
                            </div>
                        </div>

                        <div id="certResult" style="display: none;">
                            <div class="alert alert-danger">
                                <h4>User Ignored Warning!</h4>
                                <p>By proceeding, user has allowed MITM attack to succeed.</p>
                                <p>All subsequent traffic including cookies is now intercepted.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Defense Strategies -->
    <section class="section">
        <div class="container">
            <div class="card">
                <h2>üõ°Ô∏è How to Prevent MITM Attacks</h2>
                
                <div class="grid grid-2 mt-lg">
                    <div>
                        <h3>For Website Developers:</h3>
                        <ul class="defense-list">
                            <li>
                                <strong>Enforce HTTPS everywhere</strong>
                                <p>Use HTTP Strict Transport Security (HSTS)</p>
                                <code>Strict-Transport-Security: max-age=31536000; includeSubDomains</code>
                            </li>
                            <li>
                                <strong>Certificate pinning</strong>
                                <p>Pin specific certificates to prevent substitution</p>
                                <code>Public-Key-Pins: pin-sha256="base64=="</code>
                            </li>
                            <li>
                                <strong>Use secure cookie flags</strong>
                                <p>Prevent transmission over insecure connections</p>
                                <code>Set-Cookie: sessionId=xyz; Secure; SameSite=Strict</code>
                            </li>
                            <li>
                                <strong>Implement CAA records</strong>
                                <p>Control which CAs can issue certificates</p>
                                <code>example.com. CAA 0 issue "letsencrypt.org"</code>
                            </li>
                            <li>
                                <strong>Monitor Certificate Transparency</strong>
                                <p>Watch for unauthorized certificate issuance</p>
                            </li>
                        </ul>
                    </div>
                    
                    <div>
                        <h3>For Users:</h3>
                        <ul class="defense-list">
                            <li>
                                <strong>Always check for HTTPS</strong>
                                <p>Look for the lock icon before entering credentials</p>
                            </li>
                            <li>
                                <strong>Avoid public WiFi for sensitive activities</strong>
                                <p>Use VPN or mobile data for banking/shopping</p>
                            </li>
                            <li>
                                <strong>Never ignore certificate warnings</strong>
                                <p>Browser warnings are there for your protection</p>
                            </li>
                            <li>
                                <strong>Use VPN on untrusted networks</strong>
                                <p>Creates encrypted tunnel through potential MITM</p>
                            </li>
                            <li>
                                <strong>Keep devices updated</strong>
                                <p>Latest security patches protect against attacks</p>
                            </li>
                            <li>
                                <strong>Use DNS over HTTPS (DoH)</strong>
                                <p>Prevents DNS manipulation attacks</p>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Test Your Knowledge -->
                <div class="quiz-section mt-xl">
                    <h3>üß† Test Your Knowledge</h3>
                    <div class="quiz-question">
                        <p><strong>What is the most effective way to prevent MITM attacks on cookies?</strong></p>
                        <div class="quiz-options">
                            <label><input type="radio" name="q1" value="vpn"> Using a VPN</label>
                            <label><input type="radio" name="q1" value="https"> Enforcing HTTPS with HSTS</label>
                            <label><input type="radio" name="q1" value="antivirus"> Installing antivirus software</label>
                        </div>
                        <button class="btn btn-primary mt-sm" onclick="checkAnswer()">Check Answer</button>
                        <div id="quizResult" style="display: none;"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Real-World Examples -->
    <section class="section">
        <div class="container">
            <div class="card">
                <h2>üì∞ Real-World MITM Attack Cases</h2>
                
                <div class="case-studies">
                    <div class="case-study">
                        <h3>Case 1: Starbucks WiFi MITM (2014)</h3>
                        <p><strong>Target:</strong> Customers using Starbucks WiFi</p>
                        <p><strong>Method:</strong> Malicious JavaScript injection into HTTP traffic</p>
                        <p><strong>Impact:</strong> Cryptocurrency mining malware distributed to thousands</p>
                        <p><strong>Lesson:</strong> Even trusted networks can be compromised</p>
                    </div>
                    
                    <div class="case-study">
                        <h3>Case 2: NSA QUANTUM Program (2013-2014)</h3>
                        <p><strong>Target:</strong> Internet users visiting specific websites</p>
                        <p><strong>Method:</strong> Router-level traffic injection and redirection</p>
                        <p><strong>Impact:</strong> Mass surveillance and malware deployment</p>
                        <p><strong>Lesson:</strong> Nation-state level MITM attacks are possible</p>
                    </div>
                    
                    <div class="case-study">
                        <h3>Case 3: Kazakhstan Certificate Authority (2019)</h3>
                        <p><strong>Target:</strong> Citizens accessing foreign websites</p>
                        <p><strong>Method:</strong> Government-issued root certificate for MITM</p>
                        <p><strong>Impact:</strong> All HTTPS traffic potentially monitored</p>
                        <p><strong>Lesson:</strong> Certificate authorities can be compromised or coerced</p>
                    </div>
                    
                    <div class="case-study">
                        <h3>Case 4: DarkHotel APT (2014-2015)</h3>
                        <p><strong>Target:</strong> Business executives in luxury hotels</p>
                        <p><strong>Method:</strong> Compromised hotel WiFi infrastructure</p>
                        <p><strong>Impact:</strong> Corporate espionage and data theft</p>
                        <p><strong>Lesson:</strong> Targeted attacks use sophisticated MITM techniques</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Navigation -->
    <section class="section">
        <div class="container">
            <div class="navigation-cards">
                <a href="cookie-poisoning.html" class="nav-card">
                    <h3>Next: Cookie Poisoning ‚Üí</h3>
                    <p>Learn how attackers manipulate cookie values</p>
                </a>
                <a href="session-hijacking.html" class="nav-card">
                    <h3>‚Üê Previous: Session Hijacking</h3>
                    <p>Return to session hijacking attacks</p>
                </a>
            </div>
        </div>
    </section>

    <script src="app.js"></script>
    <script>
        // Network visualization animations
        function animatePacket(packetId, containerId) {
            const packet = document.getElementById(packetId);
            if (packet) {
                packet.style.animation = 'none';
                packet.offsetHeight; // Trigger reflow
                packet.style.animation = 'packet-flow 2s ease-in-out';
            }
        }

        // Secure connection demo
        document.getElementById('startSecureDemo').addEventListener('click', () => {
            animatePacket('securePacket', 'secureConnection');
            setTimeout(() => {
                alert('‚úÖ Secure connection: Cookies encrypted and protected!');
            }, 2000);
        });

        // MITM connection demo
        document.getElementById('startMitmDemo').addEventListener('click', () => {
            animatePacket('packet1', 'userToAttacker');
            setTimeout(() => {
                document.getElementById('interceptedData').style.display = 'block';
                animatePacket('packet2', 'attackerToServer');
                setTimeout(() => {
                    alert('üö® MITM attack: Cookies intercepted and visible to attacker!');
                }, 1000);
            }, 1000);
        });

        // Tab switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                // Remove active class from all tabs and content
                document.querySelectorAll('.tab-btn').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.demo-content').forEach(c => c.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding content
                btn.classList.add('active');
                document.getElementById(btn.dataset.tab + '-demo').classList.add('active');
            });
        });

        // WiFi attack demo
        document.getElementById('setupFakeWifi').addEventListener('click', () => {
            document.querySelector('.wifi-network.fake').style.background = '#ffebee';
            document.getElementById('wifiStep2').style.display = 'block';
        });

        document.getElementById('connectFakeWifi').addEventListener('click', () => {
            document.getElementById('wifiStep3').style.display = 'block';
        });

        // SSL stripping demo
        document.getElementById('demonstrateSSL').addEventListener('click', () => {
            document.getElementById('sslUrl').textContent = 'http://mybank.com/login';
            document.getElementById('sslUrl').style.color = '#dc2626';
            document.getElementById('sslIndicator').textContent = 'üîì';
            document.getElementById('sslResult').style.display = 'block';
        });

        // DNS spoofing demo
        document.getElementById('poisonDNS').addEventListener('click', () => {
            document.getElementById('dnsResponse').style.display = 'none';
            document.getElementById('maliciousResponse').style.display = 'block';
            document.getElementById('dnsResult').style.display = 'block';
        });

        // Certificate demo
        document.getElementById('showCertWarning').addEventListener('click', () => {
            document.getElementById('certWarning').style.display = 'block';
        });

        document.getElementById('proceedAnyway').addEventListener('click', () => {
            document.getElementById('certResult').style.display = 'block';
        });

        function checkAnswer() {
            const selected = document.querySelector('input[name="q1"]:checked');
            const result = document.getElementById('quizResult');
            
            if (!selected) {
                result.innerHTML = '<p class="text-warning">Please select an answer!</p>';
                result.style.display = 'block';
                return;
            }
            
            if (selected.value === 'https') {
                result.innerHTML = '<p class="text-success">‚úÖ Correct! HTTPS with HSTS provides the strongest protection against MITM attacks.</p>';
            } else {
                result.innerHTML = '<p class="text-danger">‚ùå Incorrect. While VPNs help, HTTPS with HSTS is the most fundamental protection.</p>';
            }
            
            result.style.display = 'block';
        }
    </script>

    <style>
        /* MITM-specific styles */
        .network-demo {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
            margin-top: 1rem;
        }

        .network-scenario {
            padding: 1.5rem;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-lg);
            background: var(--bg-secondary);
        }

        .network-diagram {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 1rem 0;
            position: relative;
        }

        .network-diagram.mitm {
            justify-content: space-around;
        }

        .network-node {
            text-align: center;
            position: relative;
        }

        .node-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .connection-line {
            flex: 1;
            height: 4px;
            margin: 0 1rem;
            position: relative;
            border-radius: 2px;
        }

        .connection-line.secure {
            background: linear-gradient(90deg, #059669, #10b981);
        }

        .connection-line.compromised {
            background: linear-gradient(90deg, #dc2626, #ef4444);
        }

        .data-packet {
            position: absolute;
            top: -15px;
            left: 0;
            font-size: 1.2rem;
            background: white;
            padding: 2px 4px;
            border-radius: 4px;
            box-shadow: var(--shadow-light);
        }

        .connection-label {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            white-space: nowrap;
        }

        .intercepted-data {
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #fef2f2;
            color: #dc2626;
            padding: 0.5rem;
            border-radius: 4px;
            border: 1px solid #fecaca;
            font-size: 0.8rem;
            white-space: nowrap;
        }

        @keyframes packet-flow {
            0% { left: 0; }
            100% { left: calc(100% - 30px); }
        }

        .demo-tabs {
            display: flex;
            border-bottom: 2px solid var(--border-color);
            margin-bottom: 1.5rem;
            gap: 0.5rem;
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 0.75rem 1rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: var(--transition-fast);
            font-family: var(--font-body);
            font-size: 0.9rem;
        }

        .tab-btn.active {
            border-bottom-color: var(--accent-primary);
            color: var(--accent-primary);
            font-weight: 600;
        }

        .demo-content {
            display: none;
        }

        .demo-content.active {
            display: block;
        }

        .wifi-networks {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .wifi-network {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background: var(--bg-primary);
        }

        .wifi-network.fake {
            border-color: #dc2626;
        }

        .wifi-note {
            color: #dc2626;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .browser-simulation {
            border: 2px solid var(--border-color);
            border-radius: var(--radius-lg);
            overflow: hidden;
            margin: 1rem 0;
        }

        .address-bar {
            background: var(--bg-tertiary);
            padding: 0.75rem 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-family: var(--font-mono);
            font-size: 0.9rem;
        }

        .ssl-indicator {
            font-size: 1.2rem;
        }

        .page-content {
            padding: 1.5rem;
        }

        .dns-flow {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin: 1rem 0;
        }

        .dns-step {
            padding: 0.75rem 1rem;
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            border-left: 4px solid var(--accent-info);
        }

        .certificate-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1rem 0;
        }

        .cert-valid, .cert-fake {
            padding: 1rem;
            border-radius: var(--radius-md);
            border: 2px solid var(--border-color);
        }

        .cert-valid {
            border-color: #059669;
            background: #f0fdf4;
        }

        .cert-fake {
            border-color: #dc2626;
            background: #fef2f2;
        }

        .browser-warning {
            background: #fef2f2;
            border: 2px solid #dc2626;
            border-radius: var(--radius-md);
            padding: 1.5rem;
            text-align: center;
            margin: 1rem 0;
        }

        .warning-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1rem;
        }

        @media (max-width: 768px) {
            .network-diagram {
                flex-direction: column;
                gap: 1rem;
            }

            .connection-line {
                width: 100px;
                margin: 0.5rem 0;
            }

            .demo-tabs {
                flex-wrap: wrap;
            }

            .certificate-comparison {
                grid-template-columns: 1fr;
            }
        }
    </style>
</body>
</html>